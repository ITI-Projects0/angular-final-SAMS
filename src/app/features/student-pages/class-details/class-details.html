<div class="p-6 space-y-6" *ngIf="classDetails$ | async as classDetails">
  <!-- Header -->
  <header class="bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-100 dark:border-slate-700 shadow-sm">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
      <div>
        <h1 class="text-3xl font-bold text-slate-900 dark:text-white mb-2">{{ classDetails.name }}</h1>
        <p class="text-slate-500 dark:text-slate-400 flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
          {{ classDetails.teacherName }}
        </p>
      </div>
      <div class="flex flex-col items-end gap-2">
        <span
          class="px-3 py-1 rounded-full bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400 text-sm font-medium">
          {{ classDetails.subject }}
        </span>
        <p class="text-sm text-slate-600 dark:text-slate-400 flex items-center gap-1">
          <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          Next Class: {{ classDetails.nextClassTime }}
        </p>
      </div>
    </div>
    <p class="mt-4 text-slate-600 dark:text-slate-300">{{ classDetails.description }}</p>
  </header>

  <!-- Class Schedule Calendar -->
  <div
    class="bg-white dark:bg-slate-800 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm overflow-hidden">
    <div class="p-4 border-b border-slate-100 dark:border-slate-700">
      <h2 class="text-lg font-bold text-slate-900 dark:text-white">Monthly Schedule</h2>
    </div>
    @if (schedule$ | async; as schedule) {
    <div class="p-4">
      <!-- Weekday Headers -->
      <div class="grid grid-cols-7 gap-2 mb-2">
        @for (day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']; track day) {
        <div class="text-center text-xs font-medium text-slate-500 dark:text-slate-400 py-2">{{ day }}</div>
        }
      </div>

      <!-- Calendar Grid -->
      <div class="grid grid-cols-7 gap-2">
        @for (day of getCalendarDays(); track day.date) {
        <div
          class="aspect-square border border-slate-200 dark:border-slate-600 rounded-lg p-2 hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors"
          [class.bg-slate-50]="!day.isCurrentMonth" [class.dark:bg-slate-700/20]="!day.isCurrentMonth"
          [class.border-indigo-500]="day.hasClass" [class.bg-indigo-50]="day.hasClass"
          [class.dark:bg-indigo-900/20]="day.hasClass">
          <div class="text-sm font-medium text-slate-900 dark:text-white" [class.text-slate-400]="!day.isCurrentMonth">
            {{ day.dayNumber }}
          </div>
          @if (day.hasClass) {
          <div class="mt-1">
            <div class="text-xs font-medium text-indigo-600 dark:text-indigo-400">{{ day.classTime }}</div>
            <div class="text-xs text-slate-500 dark:text-slate-400 truncate">{{ day.location }}</div>
          </div>
          }
        </div>
        }
      </div>

      <!-- Legend -->
      <div class="mt-4 pt-4 border-t border-slate-200 dark:border-slate-700">
        <div class="flex items-center gap-2 text-sm">
          <div class="w-4 h-4 rounded bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-500"></div>
          <span class="text-slate-600 dark:text-slate-400">Class Day</span>
        </div>
      </div>
    </div>
    }
  </div>

  <!-- Lessons List -->
  <div class="space-y-4">
    <h2 class="text-xl font-bold text-slate-900 dark:text-white">Lessons & Resources</h2>

    @for (lesson of classDetails.lessons; track lesson.id) {
    <div class="bg-white dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700 overflow-hidden">
      <div class="p-4 border-b border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/30">
        <h3 class="font-semibold text-lg text-slate-900 dark:text-white">{{ lesson.title }}</h3>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">{{ lesson.description }}</p>
      </div>

      <div class="p-4 space-y-3">
        @if (lesson.resources.length > 0) {
        @for (resource of lesson.resources; track resource.id) {
        @if (resource.type === 'video') {
        <a [routerLink]="['/dashboard/video']" [queryParams]="{url: resource.url, title: resource.title}"
          class="flex items-center gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors border border-transparent hover:border-slate-200 dark:hover:border-slate-600">
          <div
            class="w-10 h-10 rounded-lg flex items-center justify-center shrink-0 bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <h4 class="font-medium text-slate-900 dark:text-white">{{ resource.title }}</h4>
            <p class="text-xs text-slate-500 dark:text-slate-400">Watch Video</p>
          </div>
        </a>
        } @else {
        <a [href]="resource.url" target="_blank"
          class="flex items-center gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors border border-transparent hover:border-slate-200 dark:hover:border-slate-600">
          <div class="w-10 h-10 rounded-lg flex items-center justify-center shrink-0" [ngClass]="{
                      'bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400': resource.type === 'file',
                      'bg-emerald-50 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400': resource.type === 'link'
                    }">
            @if (resource.type === 'file') {
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            } @else {
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
            </svg>
            }
          </div>
          <div>
            <h4 class="font-medium text-slate-900 dark:text-white">{{ resource.title }}</h4>
            <p class="text-xs text-slate-500 dark:text-slate-400 capitalize">{{ resource.type }}</p>
          </div>
        </a>
        }
        }
        } @else {
        <p class="text-sm text-slate-500 dark:text-slate-400 italic px-2">No resources available for this lesson.</p>
        }
      </div>
    </div>
    } @empty {
    <div class="text-center py-12 bg-white dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700">
      <p class="text-slate-500 dark:text-slate-400">No lessons added to this class yet.</p>
    </div>
    }
  </div>
</div>