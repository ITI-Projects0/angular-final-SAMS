<section class="list-wrapper">
  <header class="list-header">
    <h2>Courses</h2>
    <p class="muted">Available courses and their instructors</p>
  </header>

  <div class="toolbar">
    <input placeholder="Search courses..." class="search" [(ngModel)]="searchTerm" (ngModelChange)="onSearchChange()" />
    <div class="toolbar-actions">
      <label class="muted">Per page</label>
      <select class="select" [(ngModel)]="perPage" (ngModelChange)="changePerPage($event)">
        <option [ngValue]="10">10</option>
        <option [ngValue]="15">15</option>
        <option [ngValue]="25">25</option>
        <option [ngValue]="50">50</option>
      </select>
    </div>
  </div>

  <div class="loading-overlay" *ngIf="loading">
    <div class="spinner"></div>
    <span>Loading courses...</span>
  </div>

  <table class="list-table glass">
    <thead>
      <tr><th>Course title</th><th>Center</th><th>Teacher</th><th>Status</th><th>Students</th><th>Actions</th></tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of filteredCourses">
        <td class="strong"><span class="truncate" title="{{ c.title }}">{{ c.title }}</span></td>
        <td><span class="pill truncate" title="{{ c.center || '-' }}">{{ c.center || '-' }}</span></td>
        <td><span class="pill truncate" title="{{ c.teacher || '-' }}">{{ c.teacher || '-' }}</span></td>
        <td><span class="pill" [ngClass]="c.status === 'Active' ? 'pill-success' : 'pill-muted'">{{ c.status }}</span></td>
        <td><span class="pill pill-ghost">{{ c.studentsCount }} students</span></td>
        <td>
          <button class="btn-simple" (click)="openInfo(c)">Info</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pagination" *ngIf="lastPage > 1 || total">
    <div class="muted small">Showing {{ rangeStart }} - {{ rangeEnd }} of {{ total }}</div>
    <div class="page-controls">
      <button class="btn-simple" [disabled]="page === 1" (click)="changePage(page - 1)">Prev</button>
      <span class="page-indicator">Page {{ page }} / {{ lastPage }}</span>
      <button class="btn-simple" [disabled]="page === lastPage" (click)="changePage(page + 1)">Next</button>
    </div>
  </div>
</section>

<div class="overlay" [class.open]="infoOpen" (click)="closeInfo()"></div>
<div class="side-panel glass" [class.open]="infoOpen" (click)="$event.stopPropagation()">
  <div class="panel-header">
    <h3>Course info</h3>
    <button class="close-btn" (click)="closeInfo()">X</button>
  </div>
  <div class="panel-body" *ngIf="selectedCourse">
    <p class="strong">{{ selectedCourse.title }}</p>
    <div class="chips">
      <div class="chip">Center: {{ selectedCourse.center || '-' }}</div>
      <div class="chip">Teacher: {{ selectedCourse.teacher || '-' }}</div>
      <div class="chip">Students: {{ selectedCourse.studentsCount }}</div>
      <div class="chip" [ngClass]="selectedCourse.status === 'Active' ? 'pill-success' : 'pill-muted'">
        Status: {{ selectedCourse.status }}
      </div>
      <div class="chip">Group ID: {{ selectedCourse.id }}</div>
      <div class="chip">Approval required: {{ selectedCourse.raw?.is_approval_required ? 'Yes' : 'No' }}</div>
    </div>
  </div>
</div>
