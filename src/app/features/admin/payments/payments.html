<section class="list-wrapper">
  <header class="list-header">
    <h2>Payments</h2>
    <p class="muted">Track which centers are paid or unpaid</p>
  </header>

  <div class="toolbar">
    <input placeholder="Search..." class="search" />
    <div style="display:flex; gap:0.6rem">
      <button class="btn-simple" [class.active]="filter==='all'" (click)="filter='all'; page=1">All</button>
      <button class="btn-simple" [class.active]="filter==='paid'" (click)="filter='paid'; page=1">Paid</button>
      <button class="btn-simple" [class.active]="filter==='unpaid'" (click)="filter='unpaid'; page=1">Unpaid</button>
    </div>
    <div class="toolbar-actions">
      <label class="muted">Per page</label>
      <select class="select" [(ngModel)]="perPage" (ngModelChange)="changePerPage($event)">
        <option [ngValue]="5">5</option>
        <option [ngValue]="10">10</option>
        <option [ngValue]="15">15</option>
      </select>
      <button class="btn-primary" (click)="openForm()">Add payment</button>
    </div>
  </div>

  <table class="list-table glass">
    <thead>
      <tr>
        <th>Center</th>
        <th>City</th>
        <th>Phone</th>
        <th>Amount</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of paginatedCenters">
        <td>{{ c.name }}</td>
        <td>{{ c.city }}</td>
        <td>{{ c.phone }}</td>
        <td>{{ c.amount | currency:'USD' }}</td>
        <td><strong [class.paid]="c.paid">{{ c.paid ? 'Paid' : 'Unpaid' }}</strong></td>
        <td>
          <button class="btn-simple" (click)="openForm(c)">Edit</button>
          <button class="btn-simple muted" (click)="delete(c)">Delete</button>
        </td>
      </tr>
      <tr *ngIf="paginatedCenters.length === 0">
        <td colspan="6" class="text-center muted">No payments found.</td>
      </tr>
    </tbody>
  </table>

  <div class="pagination" *ngIf="lastPage > 1 || total">
    <div class="muted small">Showing {{ rangeStart }} - {{ rangeEnd }} of {{ total }}</div>
    <div class="page-controls">
      <button class="btn-simple" [disabled]="page === 1" (click)="changePage(page - 1)">Prev</button>
      <span class="page-indicator">Page {{ page }} / {{ lastPage }}</span>
      <button class="btn-simple" [disabled]="page === lastPage" (click)="changePage(page + 1)">Next</button>
    </div>
  </div>
</section>

<div class="overlay" [class.open]="isFormOpen" (click)="closeForm()"></div>
<div class="side-panel glass" [class.open]="isFormOpen" (click)="$event.stopPropagation()">
  <div class="panel-header">
    <h3>{{ isEditMode ? 'Edit' : 'Add payment' }}</h3>
    <button class="close-btn" (click)="closeForm()">X</button>
  </div>
  <form class="panel-body" (ngSubmit)="save()">
    <label class="label">Center</label>
    <input class="input" name="name" [(ngModel)]="formCenter.name" required />

    <label class="label">City</label>
    <input class="input" name="city" [(ngModel)]="formCenter.city" required />

    <label class="label">Phone</label>
    <input class="input" name="phone" [(ngModel)]="formCenter.phone" required />

    <label class="label">Amount</label>
    <input class="input" type="number" name="amount" [(ngModel)]="formCenter.amount" required />

    <label class="label">Status</label>
    <select class="input" name="paid" [(ngModel)]="formCenter.paid">
      <option [ngValue]="true">Paid</option>
      <option [ngValue]="false">Unpaid</option>
    </select>

    <button type="submit" class="btn-primary full">{{ isEditMode ? 'Edit' : 'Add payment' }}</button>
  </form>
</div>